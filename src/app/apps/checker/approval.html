<div>
  <div class="flex flex-wrap items-center justify-between gap-4">
    <h2 class="text-xl">Approval Pengajuan</h2>
    <div class="flex w-full flex-col gap-4 sm:w-auto sm:flex-row sm:items-center sm:gap-3">
      <div class="relative">
        <input
          type="text"
          placeholder="Cari Nama Customer"
          class="peer form-input py-2 ltr:pr-11 rtl:pl-11"
          [(ngModel)]="searchNamaCustomer"
          name="searchNamaCustomer"
          (ngModelChange)="filterPengajuan()"
        />
        <div class="absolute top-1/2 -translate-y-1/2 ltr:right-[11px] rtl:left-[11px] peer-focus:text-primary">
          <icon-search class="mx-auto" />
        </div>
      </div>
    </div>
  </div>

  <div class="panel mt-5 overflow-hidden border-0 p-0">
    <div class="table-responsive">
      <table class="table-striped table-hover">
        <thead>
          <tr>
            <th>Nama Customer</th>
            <th>Jumlah</th>
            <th>Tenor</th>
            <th>Tanggal Pengajuan</th>
            <th>Status</th>
            <th>Catatan Marketing</th>
            <th class="text-center">Aksi</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of filteredRows">
            <td>{{ item.namaCustomer }}</td>
            <td>{{ item.amount | currency: 'IDR' }}</td>
            <td>{{ item.tenor }}</td>
            <td>{{ item.tanggalPengajuan | date: 'short' }}</td>
            <td>{{ item.status }}</td>
            <td>{{ item.catatanMarketing }}</td>
            <td class="text-center">
              <div class="flex items-center justify-center gap-3">
                <button class="btn btn-sm btn-primary" (click)="openReviewModal(item)">Review</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Modal Review -->
  <ngx-custom-modal #modalReview class="modal-top w-[50%]">
    <ng-template #modalHeader>
      <h3 class="text-lg font-semibold mb-4">Review Pengajuan</h3>
    </ng-template>

    <ng-template #modalBody>
      <div *ngIf="selectedPengajuan">
        <div class="mb-4" *ngFor="let field of reviewFields">
          <label class="font-medium">{{ field.label }}</label>
          <input
            type="text"
            class="w-full p-2 border rounded mt-1"
            [value]="field.value"
            readonly
          />
        </div>

        <div class="mb-4">
          <label class="font-medium">Catatan Manager</label>
          <textarea [(ngModel)]="catatanManager" rows="4" class="form-textarea w-full mt-1"></textarea>
        </div>

        <div class="flex justify-between">
          <button (click)="submitReview(true)" class="btn btn-success">Setujui</button>
          <button (click)="submitReview(false)" class="btn btn-danger">Tolak</button>
        </div>
      </div>
    </ng-template>

    <ng-template #modalFooter>
      <button type="button" class="btn btn-outline-danger" (click)="modalReview.close()">Tutup</button>
    </ng-template>
  </ngx-custom-modal>
</div>
