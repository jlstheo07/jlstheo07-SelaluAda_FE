import{g as a,i,ra as n,sa as l}from"./chunk-7MBT376S.js";var d=(()=>{let o=class o{constructor(t){this.http=t,this.baseUrl="http://localhost:8080/auth"}login(t,e){let r={usernameOrEmail:t,password:e};return this.http.post(`${this.baseUrl}/login`,r)}changePassword(t,e){let r=this.getToken(),h=new n({Authorization:`Bearer ${r}`,"Content-Type":"application/json"}),c={oldPassword:t,newPassword:e};return this.http.put(`${this.baseUrl}/change-password`,c,{headers:h,observe:"response"})}resetPassword(t,e){let r={token:t,newPassword:e};return this.http.post(`${this.baseUrl}/reset-password`,r)}forgotPassword(t){return this.http.post(`${this.baseUrl}/forgot-password`,{email:t})}saveToken(t){localStorage.setItem("auth_token",t)}getToken(){return localStorage.getItem("auth_token")}isLoggedIn(){return!!this.getToken()}saveRole(t){localStorage.setItem("user_role",t)}getRole(){return localStorage.getItem("user_role")}logout(){let t=this.getToken();if(!t){this.clearSession();return}let e=new n({Authorization:`Bearer ${t}`});this.http.post(`${this.baseUrl}/logout`,{},{headers:e}).subscribe({next:()=>{this.clearSession()},error:r=>{console.error("Logout error:",r),this.clearSession()}})}clearSession(){localStorage.removeItem("auth_token"),localStorage.removeItem("user_role"),window.location.href="/auth/boxed-signin"}};o.\u0275fac=function(e){return new(e||o)(i(l))},o.\u0275prov=a({token:o,factory:o.\u0275fac,providedIn:"root"});let s=o;return s})();export{d as a};
